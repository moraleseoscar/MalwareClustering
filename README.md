# Malware Similarity Analysis

## Introduction
The goal of this project is to utilize clustering algorithms with the results obtained from similarity analysis to identify families of malware. The similarity analysis is based on the Jaccard index, comparing features extracted from malware samples. Each dot graph generated from the analysis was also converted to a PNG image for better visualization.

## Features
- **Strings**: Strings extracted from the malware executables using the `strings` command-line tool. These strings represent human-readable text found within the executable files.
- **Function Calls**: Function calls extracted from the Portable Executable (PE) files using the `pefile` Python library. These function calls represent the dynamic linking behavior of the malware and can provide insights into its functionality.

## Clustering Algorithms
- **K-means**: A partitioning clustering algorithm that aims to divide the samples into a predefined number of clusters by minimizing the within-cluster variance.
- **K-medoids**: Similar to K-means but uses medoids (the most centrally located points) as cluster centers instead of the mean. This makes K-medoids more robust to outliers.
- **DBSCAN**: A density-based clustering algorithm that groups together samples that are closely packed, identifying clusters as areas of high density separated by areas of low density.

## Results
- **K-means**: The highest Silhouette coefficient is achieved with 9 clusters, suggesting approximately 9 distinct malware families.
- **K-medoids**: The highest Silhouette coefficient is 0.4777 for 10 clusters. However, there is some variability in the estimation of the optimal number of clusters.
- **DBSCAN**: The highest Silhouette coefficient varies depending on the parameters, indicating a more complex underlying structure and less defined number of malware families.


## Conclusion
The analysis reveals variability in the estimation of the optimal number of clusters and thus the number of malware families identified. K-means and K-medoids suggest around 9 or 10 clusters, corresponding to approximately 9 malware families. However, DBSCAN results suggest a more complex structure with varying numbers of families depending on parameter settings.

The use of different features (strings and function calls) also influences the clustering results. While strings-based clustering tends to produce fewer but more defined clusters, function call-based clustering yields a larger number of clusters, indicating a more diverse set of malware families.

Overall, the analysis provides insights into the effectiveness of different clustering algorithms and features for malware similarity analysis, highlighting the importance of considering multiple factors when analyzing malware samples.

## Usage
1. Clone the repository.
2. Place malware samples in the `MALWR` directory (not included in the repository for security reasons).
3. Change the python script arguments in `malware_similarity_analysis.py` to your preference :
   - `--output_directory`: Output directory for dot files (default: `./Results/FunctionCalls/`).
   - `--feature`: Feature to analyze (`strings` or `function_calls`, default: `strings`).
   - Example: `python malware_similarity_analysis.py MALWR --output_directory ./Results/FunctionCalls/ --feature function_calls`
   - Note: Modify the `MALWR` directory path to point to the location where you have stored the malware samples.
4. Analyze the results using generated dot files and images.


> **⚠️ Note:**  
>Please note that the malware samples directory is not included in the repository for security reasons. However, you can contact me if you need the zip file containing the malware samples used for this study.


## Requirements
- Python 3.x
- `networkx` Python library
- `pefile` Python library

